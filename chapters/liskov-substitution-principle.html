<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="112. Variant classes" href="variant-classes.html" /><link rel="prev" title="110. Invariance" href="invariance.html" />

    <!-- Generated with Sphinx 5.0.2 and Furo 2023.03.27 -->
        <title>111. Liskov substitution principle - The Object Oriented Way</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">The Object Oriented Way</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">The Object Oriented Way</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="syntax.html">1. Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="hello-world.html">2. Hello world</a></li>
<li class="toctree-l1"><a class="reference internal" href="compilation.html">3. Compilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="execution.html">4. Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpretation.html">5. Interpretation</a></li>
<li class="toctree-l1"><a class="reference internal" href="comments.html">6. Comments</a></li>
<li class="toctree-l1"><a class="reference internal" href="values.html">7. Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="variables.html">8. Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-types.html">9. Data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressions.html">10. Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="arithmetic-operators.html">11. Arithmetic operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="equality-operators.html">12. Equality operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="relational-operators.html">13. Relational operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="logical-operators.html">14. Logical operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="assignment-operator.html">15. Assignment operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="precedence.html">16. Precedence</a></li>
<li class="toctree-l1"><a class="reference internal" href="associativity.html">17. Associativity</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">18. Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="statements.html">19. Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="type-inference.html">20. Type inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="type-checking.html">21. Type checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="floating-point-types.html">22. Floating-point types</a></li>
<li class="toctree-l1"><a class="reference internal" href="enumeration-types.html">23. Enumeration types</a></li>
<li class="toctree-l1"><a class="reference internal" href="selection-statements.html">24. Selection statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="selection-expressions.html">25. Selection expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="iteration.html">26. Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="arrays.html">27. Arrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference-types.html">28. Reference types</a></li>
<li class="toctree-l1"><a class="reference internal" href="value-types.html">29. Value types</a></li>
<li class="toctree-l1"><a class="reference internal" href="local-functions.html">30. Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="fat-arrows.html">31. Fat arrows</a></li>
<li class="toctree-l1"><a class="reference internal" href="recursion.html">32. Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="namespaces.html">33. Namespaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="objects.html">34. Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">35. Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="access-modifiers.html">36. Access modifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="fields.html">37. Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructors.html">38. Constructors</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-this-keyword.html">39. The <code class="docutils literal notranslate"><span class="pre">this</span></code> keyword</a></li>
<li class="toctree-l1"><a class="reference internal" href="instance-methods.html">40. Instance methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="encapsulation.html">41. Encapsulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto-implemented-properties.html">42. Auto-implemented properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="manually-implemented-properties.html">43. Manually implemented properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="object-initializers.html">44. Object initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="read-only-fields.html">45. Read-only fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="read-only-properties.html">46. Read-only properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="computed-properties.html">47. Computed properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="required-properties-and-fields.html">48. Required properties and fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="init-only-properties.html">49. Init-only properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="instance-method-overloading.html">50. Instance method overloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructor-overloading.html">51. Constructor overloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-fields.html">52. Static fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-constructors.html">53. Static constructors</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-methods.html">54. Static methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-properties.html">55. Static properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-classes.html">56. Static classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="top-level-statements.html">57. Top-level statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="object-composition.html">58. Object composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">59. Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="subtype-polymorphism.html">60. Subtype polymorphism</a></li>
<li class="toctree-l1"><a class="reference internal" href="run-time-type-vs-compile-time-type.html">61. Run-time type vs compile-time type</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic-dispatch.html">62. Dynamic dispatch</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple-interfaces.html">63. Multiple interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="default-interface-methods.html">64. Default interface methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="inheritance.html">65. Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="overriding.html">66. Overriding</a></li>
<li class="toctree-l1"><a class="reference internal" href="hiding.html">67. Hiding</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-base-keyword.html">68. The <code class="docutils literal notranslate"><span class="pre">base</span></code> keyword</a></li>
<li class="toctree-l1"><a class="reference internal" href="constructor-chaining.html">69. Constructor chaining</a></li>
<li class="toctree-l1"><a class="reference internal" href="protected.html">70. Protected access modifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstract-classes.html">71. Abstract classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface-inheritance.html">72. Interface inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="type-conversions.html">73. Type conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="upcasting.html">74. Upcasting</a></li>
<li class="toctree-l1"><a class="reference internal" href="downcasting.html">75. Downcasting</a></li>
<li class="toctree-l1"><a class="reference internal" href="everything-is-an-object.html">76. Everything is an object</a></li>
<li class="toctree-l1"><a class="reference internal" href="uml-class-diagrams.html">77. UML class diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="maintainability.html">78. Maintainability</a></li>
<li class="toctree-l1"><a class="reference internal" href="refactoring.html">79. Refactoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="generics.html">80. Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-types.html">81. Generic types</a></li>
<li class="toctree-l1"><a class="reference internal" href="generics-and-type-errors.html">82. Generics and type errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-supertypes.html">83. Generic supertypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-methods.html">84. Generic methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="type-parameter-constraints.html">85. Type parameter constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="collections.html">86. Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="collection-initializers.html">87. Collection initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="replace-conditional-with-polymorphism.html">88. Replace conditional with polymorphism</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependency-injection.html">89. Dependency injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="composition-over-inheritance.html">90. Composition over inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="strategy-pattern.html">91. Strategy pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="bridge-pattern.html">92. Bridge pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="delegates.html">93. Delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-delegates.html">94. Generic delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="built-in-delegates.html">95. Built-in delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="multicast-delegates.html">96. Multicast delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambdas.html">97. Lambdas</a></li>
<li class="toctree-l1"><a class="reference internal" href="observer-pattern.html">98. Observer pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">99. Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="event-conventions.html">100. Event conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="event-driven-programming.html">101. Event-driven programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="iterator-pattern.html">102. Iterator pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="enumerables.html">103. Enumerables</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-yield-statement.html">104. The <code class="docutils literal notranslate"><span class="pre">yield</span></code> statement</a></li>
<li class="toctree-l1"><a class="reference internal" href="anonymous-types.html">105. Anonymous types</a></li>
<li class="toctree-l1"><a class="reference internal" href="linq.html">106. LINQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="variance.html">107. Variance</a></li>
<li class="toctree-l1"><a class="reference internal" href="covariance.html">108. Covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="contravariance.html">109. Contravariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="invariance.html">110. Invariance</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">111. Liskov substitution principle</a></li>
<li class="toctree-l1"><a class="reference internal" href="variant-classes.html">112. Variant classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="variant-delegates.html">113. Variant delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="variant-generic-delegates.html">114. Variant generic delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="variant-generic-interfaces.html">115. Variant generic interfaces</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Labs (part 1)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../labs/fields.html">Lab: Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/instance-methods.html">Lab: Instance methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/encapsulation.html">Lab: Encapsulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/instance-method-overloading.html">Lab: Instance Method Overloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/constructor-overloading.html">Lab: Constructor overloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/manually-implemented-properties.html">Lab: Manually implemented properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/computed-properties.html">Lab: Computed Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/static.html">Lab: Static</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/object-composition.html">Lab: Object composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/interfaces.html">Lab: Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/subtype-polymorphism.html">Lab: Subtype polymorphism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/overriding.html">Lab: Overriding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/default-interface-methods.html">Lab: Default Interface Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/the-base-keyword.html">Lab: The <code class="docutils literal notranslate"><span class="pre">base</span></code> keyword</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/constructor-chaining.html">Lab: Constructor Chaining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/protected.html">Lab: <code class="docutils literal notranslate"><span class="pre">protected</span></code> access modifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/abstract-classes.html">Lab: Abstract Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/type-conversions.html">Lab: Type Conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/dependency-injection.html">Lab: Dependency injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/replace-conditional-with-polymorphism.html">Lab: Replace conditional with polymorphism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/composition-over-inheritance.html">Lab: Composition over Inheritance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Labs (part 2)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../labs/generics.html">Lab: Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/generic-types.html">Lab: Generic types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/generic-supertypes.html">Lab: Generic Supertypes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/type-parameter-constraints.html">Lab: Type parameter constraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/bridge-pattern.html">Lab: Bridge Pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/delegates.html">Lab: Delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/lambdas.html">Lab: Lambdas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/observer-pattern.html">Lab: Observer Pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/events.html">Lab: Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/iterator-pattern.html">Lab: Iterator pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/enumerables.html">Lab: Enumerables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/the-yield-keyword.html">Lab: The <code class="docutils literal notranslate"><span class="pre">yield</span></code> keyword</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/variant-classes.html">Lab: Variant classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/variant-delegates.html">Lab: Variant delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/variant-generic-delegates.html">Lab: Variant Generic Delegates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/variant-generic-interfaces.html">Lab: Variant Generic Interfaces</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section class="tex2jax_ignore mathjax_ignore" id="liskov-substitution-principle">
<h1><span class="section-number">111. </span>Liskov substitution principle<a class="headerlink" href="#liskov-substitution-principle" title="Permalink to this heading">#</a></h1>
<p>Imagine that you have a class called <code class="docutils literal notranslate"><span class="pre">Square</span></code> and another called <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code>. Which is the subtype and which is the supertype?
In mathematics, a square is a special type of rectangle so it might seem reasonable to let <code class="docutils literal notranslate"><span class="pre">Square</span></code> be a subclass that inherits from <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code>.
However, in object oriented programming, this might lead to very unexpected behavior.
This is the famous ‘Circle-ellipse problem’, also known as the ‘Square-rectangle problem’.</p>
<figure class="align-default" id="id1">
<img alt="../_images/cover-lsp.jpg" src="../_images/cover-lsp.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 111.1 </span><span class="caption-text">While a square is a rectangle in mathematics, translating this relationship directly into object oriented programming can lead to unexpected behavior. This is known as the ‘Circle-ellipse problem’ or ‘Square-rectangle problem’.</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The purpose of the, so called, Liskov Substitution Principle (LSP) is to help us avoid creating type hierarchies that don’t make any sense.
Like <code class="docutils literal notranslate"><span class="pre">Square</span></code> inheriting from <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code>.
Because such hierarchies are likely to lead to bugs.
The principle ensures that our subtypes truly extend the functionality of our supertypes without breaking any implied ‘contracts’.</p>
<div class="admonition-key-point admonition">
<p class="admonition-title">Key point</p>
<p>The Liskov substitution principle ensures that an instance of a subclass can be used wherever an instance of its superclass is expected, without affecting the correctness of the program.</p>
</div>
<section id="the-circle-ellipse-problem">
<h2>The Circle-ellipse problem<a class="headerlink" href="#the-circle-ellipse-problem" title="Permalink to this heading">#</a></h2>
<p>Let’s dive deeper into the Square-rectangle problem.
Imagine a <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code> class with two settable properties called <code class="docutils literal notranslate"><span class="pre">Width</span></code> and <code class="docutils literal notranslate"><span class="pre">Height</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Rectangle</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Width</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">virtual</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Height</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="k">set</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<div>
    <div id='dotnet-interactive-this-cell-5011.Microsoft.DotNet.Interactive.Http.HttpPort' style='display: none'>
        The below script needs to be able to find the current output cell; this is an easy method to get it.
    </div>
    <script type='text/javascript'>
async function probeAddresses(probingAddresses) {
    function timeout(ms, promise) {
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                reject(new Error('timeout'))
            }, ms)
            promise.then(resolve, reject)
        })
    }

    if (Array.isArray(probingAddresses)) {
        for (let i = 0; i < probingAddresses.length; i++) {

            let rootUrl = probingAddresses[i];

            if (!rootUrl.endsWith('/')) {
                rootUrl = `${rootUrl}/`;
            }

            try {
                let response = await timeout(1000, fetch(`${rootUrl}discovery`, {
                    method: 'POST',
                    cache: 'no-cache',
                    mode: 'cors',
                    timeout: 1000,
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: probingAddresses[i]
                }));

                if (response.status == 200) {
                    return rootUrl;
                }
            }
            catch (e) { }
        }
    }
}

function loadDotnetInteractiveApi() {
    probeAddresses(["http://10.1.0.43:2048/", "http://127.0.0.1:2048/"])
        .then((root) => {
        // use probing to find host url and api resources
        // load interactive helpers and language services
        let dotnetInteractiveRequire = require.config({
        context: '5011.Microsoft.DotNet.Interactive.Http.HttpPort',
                paths:
            {
                'dotnet-interactive': `${root}resources`
                }
        }) || require;

            window.dotnetInteractiveRequire = dotnetInteractiveRequire;

            window.configureRequireFromExtension = function(extensionName, extensionCacheBuster) {
                let paths = {};
                paths[extensionName] = `${root}extensions/${extensionName}/resources/`;
                
                let internalRequire = require.config({
                    context: extensionCacheBuster,
                    paths: paths,
                    urlArgs: `cacheBuster=${extensionCacheBuster}`
                    }) || require;

                return internalRequire
            };
        
            dotnetInteractiveRequire([
                    'dotnet-interactive/dotnet-interactive'
                ],
                function (dotnet) {
                    dotnet.init(window);
                },
                function (error) {
                    console.log(error);
                }
            );
        })
        .catch(error => {console.log(error);});
    }

// ensure `require` is available globally
if ((typeof(require) !==  typeof(Function)) || (typeof(require.config) !== typeof(Function))) {
    let require_script = document.createElement('script');
    require_script.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js');
    require_script.setAttribute('type', 'text/javascript');
    
    
    require_script.onload = function() {
        loadDotnetInteractiveApi();
    };

    document.getElementsByTagName('head')[0].appendChild(require_script);
}
else {
    loadDotnetInteractiveApi();
}

    </script>
</div></div></div>
</div>
<p>Suppose that the class <code class="docutils literal notranslate"><span class="pre">Square</span></code> inherits from <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code> without overriding any of its members.
We will then be able to change the width of a <code class="docutils literal notranslate"><span class="pre">Square</span></code> instance without simultaneously changing its height. Which means that we will end up with <code class="docutils literal notranslate"><span class="pre">Square</span></code> instances that aren’t squares.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Square</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Rectangle</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// No overrides.</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="c1">// This square does not behave like a square.</span>
<span class="n">Square</span><span class="w"> </span><span class="n">square</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Square</span><span class="p">();</span>

<span class="c1">// Expecting this to change both width and height.</span>
<span class="n">square</span><span class="p">.</span><span class="n">Width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">;</span>

<span class="c1">// Expecting 10 x 10.</span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;{square.Width} x {square.Height}&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10 x 1
</pre></div>
</div>
</div>
</div>
<p>What if <code class="docutils literal notranslate"><span class="pre">Square</span></code> overrides these properties and redefines the behavior so that both methods change width and height at the same time?
Then we won’t end up with instances of <code class="docutils literal notranslate"><span class="pre">Square</span></code> that aren’t squares, but we’ve instead violated the contract of <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Square</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Rectangle</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">width</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="p">;</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Width</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">get</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">width</span><span class="p">;</span>
<span class="w">        </span><span class="k">set</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="k">value</span><span class="p">;</span><span class="w"> </span><span class="n">height</span><span class="o">=</span><span class="k">value</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">public</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Height</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">get</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">height</span><span class="p">;</span>
<span class="w">        </span><span class="k">set</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">height</span><span class="o">=</span><span class="k">value</span><span class="p">;</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="k">value</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>When we <a class="reference internal" href="upcasting.html"><span class="doc std std-doc">upcast</span></a> an instance of a subtype (like <code class="docutils literal notranslate"><span class="pre">Circle</span></code>) to a supertype (like <code class="docutils literal notranslate"><span class="pre">Ellipse</span></code>) then the <a class="reference internal" href="run-time-type-vs-compile-time-type.html"><span class="doc std std-doc">compile-time type</span></a> will be the supertype. At that point we expect the object to behave in accordance with the ‘contract’ of the supertype, and will be utterly surprised if it doesn’t.</p>
</div>
<p>Remember, since <code class="docutils literal notranslate"><span class="pre">Square</span></code> is a <a class="reference internal" href="subtype-polymorphism.html"><span class="doc std std-doc">subtype</span></a> of <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code> it should be possible to use it wherever a <code class="docutils literal notranslate"><span class="pre">Rectangle</span></code> is expected and it should behave like one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="c1">// This rectangle doesn&#39;t behave like a rectangle.</span>
<span class="n">Rectangle</span><span class="w"> </span><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Square</span><span class="p">();</span>

<span class="c1">// Expecting the properties to be independent.</span>
<span class="n">rect</span><span class="p">.</span><span class="n">Width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">;</span>
<span class="n">rect</span><span class="p">.</span><span class="n">Height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">;</span>

<span class="c1">// Expecting 10 x 2.</span>
<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">$&quot;{rect.Width} x {rect.Height}&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 x 2
</pre></div>
</div>
</div>
</div>
<p>So, what’s the takeaway?
Well, if we want to keep the properties <code class="docutils literal notranslate"><span class="pre">Width</span></code> and <code class="docutils literal notranslate"><span class="pre">Height</span></code>, then there cannot be a subtyping relation</p>
</section>
<section id="definition">
<h2>Definition<a class="headerlink" href="#definition" title="Permalink to this heading">#</a></h2>
<p>The Liskov Substitution Principle is a notion of ‘behavioral subtyping’ first introduced by Liskov in an influential keynote address and later refined in a <a class="reference external" href="https://dl.acm.org/doi/10.1145/197320.197383">paper</a> by Barbara Liskov and Jeanette Wing.
In essence, the principle states that objects of a superclass should be replaceable with objects of a subclass without affecting the correctness of the program.</p>
<blockquote class="epigraph">
<div><p><em>Formal definition</em>: Let <span class="math notranslate nohighlight">\(P(x)\)</span> be a property provable about objects <span class="math notranslate nohighlight">\(x\)</span> of type <span class="math notranslate nohighlight">\(T\)</span>. Then <span class="math notranslate nohighlight">\(P(x)\)</span> should be true for objects <span class="math notranslate nohighlight">\(y\)</span> of type <span class="math notranslate nohighlight">\(S\)</span> where <span class="math notranslate nohighlight">\(S\)</span> is a subtype of <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p class="attribution">—<a class="reference external" href="https://dl.acm.org/doi/10.1145/197320.197383">Liskov &amp; Wing (1994)</a></p>
</div></blockquote>
<p>The principle stipulates some type rules and some behavioral rules.
All or some of the type rules are usually implemented by compilers while the behavioral rules have to be respected by developers.</p>
</section>
<section id="robustness-principle">
<h2>Robustness principle<a class="headerlink" href="#robustness-principle" title="Permalink to this heading">#</a></h2>
<p>The ‘Robustness Principle’ (also known as ‘Postels law’) was originally formulated for the specification of TCP but serves as a great mnemonic for both the type and behavioral rules of the Liskov substitution principle as well as <a class="reference internal" href="type-checking.html"><span class="doc std std-doc">type-safe</span></a> <a class="reference internal" href="variance.html"><span class="doc std std-doc">variance</span></a>.</p>
<blockquote class="epigraph">
<div><p>Be conservative in what you do, be liberal in what you accept from others.</p>
<p class="attribution">—<a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc761">Postel (1980)</a></p>
</div></blockquote>
<p>Essentially, it recommends that subtypes should be <a class="reference internal" href="contravariance.html"><span class="doc std std-doc">contravariant</span></a> in their input parameters - meaning they should accept the same or broader types of data than their supertypes - and <a class="reference internal" href="covariance.html"><span class="doc std std-doc">covariant</span></a> in their output - restricting themselves to output types that are the same or more specific than those of their supertypes.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A subtype needs to be able to accept any value that the supertype can accept.
Conversely, a subtype must only produces values that the supertype could produce.</p>
</div>
<p>Let’s think of this in terms of set theory and the visualization in <a class="reference internal" href="#fig-robustness-principle"><span class="std std-numref">Fig. 111.2</span></a>.
The set of possible values that a method in the subtype should be able to accept must be the same as or a superset of the set of input that the method in the supertype can accept.
Conversely, the set of possible values that a method in the subtype should be allowed to return must be the same or a subset of the set of output values that the method in the supertype can return.</p>
<figure class="align-default" id="fig-robustness-principle">
<img alt="../_images/robustness-principle.png" src="../_images/robustness-principle.png" />
<figcaption>
<p><span class="caption-number">Fig. 111.2 </span><span class="caption-text">The set of input that the subtype can accept should be the same or a superset of the input that the super
The set of output that the subtype produces should be the same or a subset of the output that the supertype produces.</span><a class="headerlink" href="#fig-robustness-principle" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="type-rules">
<h2>Type rules<a class="headerlink" href="#type-rules" title="Permalink to this heading">#</a></h2>
<p>To follow the Liskov substitution principle we must adhere to the follow three type rules:</p>
<ol class="arabic simple">
<li><p>Subtype <strong>method parameter</strong> must be <strong>contravariant</strong>.</p></li>
<li><p>Subtype <strong>method return types</strong> must be <strong>covariant</strong>.</p></li>
<li><p>Subtype <strong>exceptions</strong> must all be <strong>the same type or subtypes</strong> of exceptions in the supertype.</p></li>
</ol>
<p>In line with the Robustness Principle, contravariant method parameters dictate that subtypes should accept the same or more general input types as their supertypes, ensuring no unexpected rejections.</p>
<p>Similarly, covariant method return types require subtypes to have the same or more specialized output types as their supertypes, preventing any surprises for users familiar only with the supertype.</p>
<p>The “no new exceptions” rule stipulates that any exceptions thrown by the subtype should be the same type or a subtype of those thrown by the supertype, again avoiding unexpected behavior for users.</p>
</section>
<section id="behavioral-rules">
<h2>Behavioral rules<a class="headerlink" href="#behavioral-rules" title="Permalink to this heading">#</a></h2>
<p>The Liskov substitution principle stipulates the following four behavioral rules:</p>
<ul class="simple">
<li><p><strong>Preconditions</strong> must be the <strong>same or <em>weaker</em></strong> in the subtype.</p></li>
<li><p><strong>Postconditions</strong> must be the <strong>same or <em>stronger</em></strong> in the subtype.</p></li>
<li><p><strong>Single-state invariants</strong> must be the <strong>same</strong> in subtype.</p></li>
<li><p><strong>Multi-state invariants</strong> must be the <strong>same</strong> in subtype (this is also known as the ‘history rule’).</p></li>
</ul>
<p>These rules hinge on three types of ‘predicates’ used in formal program specification: preconditions, postconditions, and invariants.
Predicates are logical statements that can be either true or false.</p>
<p><em>Preconditions</em> are the predicates that must be satisfied before executing a method.
For example, a method requiring a positive integer input will throw an exception if given a negative one.</p>
<p><em>Postconditions</em> are predicates that must be true after a method’s execution to validate its implementation.
For example a function returning the absolute value of a number must never produce a negative number.
In the Square-rectangle problem we violated the postconditions of the property <code class="docutils literal notranslate"><span class="pre">Width</span></code> when the subclass <code class="docutils literal notranslate"><span class="pre">Square</span></code> changed both <code class="docutils literal notranslate"><span class="pre">Width</span></code> and <code class="docutils literal notranslate"><span class="pre">Height</span></code>.</p>
<p><em>Single-state invariants</em> are predicates that must constantly hold true within a type, like an instance variable staying within certain limits.</p>
<p><em>Multi-state invariants</em> are predicates that need to be true across various states.
This could mean, for instance, that a value must either stay the same or increase, but never decrease.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Some languages have native support, so called, ‘formal specification’ which is concerned with preconditions, postconditions and invariants. Other languages, such as C#, have extensions such as <a class="reference external" href="https://www.microsoft.com/en-us/research/project/spec/">Spec#</a> that provide more compile-time and run-time support for verifying such predicates.
All this allows us to express the behavioral rules of the Liskov substitution principle in code.
However, principle doesn’t mandate the use of such tools, it merely employs formal terminology to clarify the meaning of substitutability.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>To learn more about how behavioral rules could be implemented by compilers I recommend that you read more about <a class="reference external" href="https://en.wikipedia.org/wiki/Design_by_contract">Design By Contract</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/Dependent_type">Dependent Types</a>.</p>
</div>
</section>
<section id="violations-of-liskov-substitution-principle-in-net">
<h2>Violations of Liskov substitution principle in .NET<a class="headerlink" href="#violations-of-liskov-substitution-principle-in-net" title="Permalink to this heading">#</a></h2>
<p>We discussed the widely used generic interface <a class="reference external" href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.generic.icollection-1"><code class="docutils literal notranslate"><span class="pre">ICollection&lt;T&gt;</span></code></a> in the chapter on <a class="reference internal" href="collections.html"><span class="doc std std-doc">collections</span></a>.
There’s tons of collections like lists, sets, and dictionaries.
One method in the interface is <code class="docutils literal notranslate"><span class="pre">Add</span></code>, which is designed to add items to the collection.</p>
<p>In .NET there’s a class called <a class="reference external" href="https://learn.microsoft.com/en-us/dotnet/api/system.collections.objectmodel.readonlycollection-1"><code class="docutils literal notranslate"><span class="pre">ReadOnlyCollection&lt;T&gt;</span></code></a>.
This class can’t possible support <code class="docutils literal notranslate"><span class="pre">Add</span></code> since its very idea is to be read-only.
Right?
Well, turns out that it actually implements <code class="docutils literal notranslate"><span class="pre">ICollection&lt;T&gt;</span></code>. 🤯</p>
<p>Now, is this a violation of the Liskov substitution principle?
Actually, it’s not.
Why?
Well, if this was the whole truth then it would have been.
But in the documentation of <code class="docutils literal notranslate"><span class="pre">ICollection&lt;T&gt;</span></code> it says that the <code class="docutils literal notranslate"><span class="pre">Add</span></code> method may throw a <code class="docutils literal notranslate"><span class="pre">NotSupportedException</span></code> if the collection in question does not support adding. 😤</p>
<p>So, <code class="docutils literal notranslate"><span class="pre">ReadOnlyCollection&lt;T&gt;</span></code> is not actually violating the ‘contract’ of <code class="docutils literal notranslate"><span class="pre">ICollection&lt;T&gt;</span></code> because the documentation of <code class="docutils literal notranslate"><span class="pre">Add</span></code> in <code class="docutils literal notranslate"><span class="pre">ICollection&lt;T&gt;</span></code> may throw an exception, which this particular implementation happens to do.</p>
<p>Although it’s not strictly a violation, this design weakens the interface’s usefulness.
The whole point of <a class="reference internal" href="type-checking.html"><span class="doc std std-doc">compile-time type-checking</span></a> is to discover errors at compile-time instead of at run-time.
So, an interface whose methods might throw exceptions is <span class="xref myst"><em>significantly</em> less useful</span> than one whose methods don’t.</p>
<p>Also, from the perspective of a programmer who fails to discover this detail in the manual, this looks and behaves like a violation of the Liskov substitution principle.
This is a completely unnecessary mess.</p>
<p>The motive might have been pragmatism. Perhaps to make collection-related features like <a class="reference internal" href="linq.html"><span class="doc std std-doc">LINQ</span></a> work for read-only collections as well.
But doing the wrong thing and calling it pragmatism is a slippery slope.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There’s also <code class="docutils literal notranslate"><span class="pre">IReadOnlyCollection&lt;T&gt;</span></code> that appropriately doesn’t subtype <code class="docutils literal notranslate"><span class="pre">ICollection&lt;T&gt;</span></code>, making the decision for <code class="docutils literal notranslate"><span class="pre">ReadOnlyCollection&lt;T&gt;</span></code> to implement <code class="docutils literal notranslate"><span class="pre">ICollection&lt;T&gt;</span></code> seem even more questionable.</p>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>The Liskov substitution principle isn’t just theoretical but has practical implications. Violating it leads to unintuitive type hierarchies which can cause unexpected bugs that are difficult to trace and fix, resulting in software that’s hard to <a class="reference internal" href="maintainability.html"><span class="doc std std-doc">maintain</span></a> and extend.</p>
<p>The core tenet is simple but powerful: <strong>a subclass should be able to stand in for its superclass without altering the correctness of the program</strong>.</p>
<div class="admonition-rule-of-thumb admonition">
<p class="admonition-title">Rule of thumb</p>
<p>In the subtype, input can be liberal, output must be conservative, invariants must hold, and no new exceptions must be introduced.</p>
</div>
<p>So the next time you’re about to create a subtype, pause for a moment and ask yourself whether it truly adheres to the Liskov substitution principle. Your future self, and teammates will thank you for it.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ".net-csharp"
        },
        kernelOptions: {
            name: ".net-csharp",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = '.net-csharp'</script>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="variant-classes.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">112. </span>Variant classes</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="invariance.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">110. </span>Invariance</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; All rights reserved. By using this site, you agree to our use of cookies for Google Analytics.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">111. Liskov substitution principle</a><ul>
<li><a class="reference internal" href="#the-circle-ellipse-problem">The Circle-ellipse problem</a></li>
<li><a class="reference internal" href="#definition">Definition</a></li>
<li><a class="reference internal" href="#robustness-principle">Robustness principle</a></li>
<li><a class="reference internal" href="#type-rules">Type rules</a></li>
<li><a class="reference internal" href="#behavioral-rules">Behavioral rules</a></li>
<li><a class="reference internal" href="#violations-of-liskov-substitution-principle-in-net">Violations of Liskov substitution principle in .NET</a></li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/analytics.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>